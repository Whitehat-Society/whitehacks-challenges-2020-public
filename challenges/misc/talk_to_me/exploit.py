#!/usr/bin/env python

from pwn import *

r = remote('chals.whitehacks.ctf.sg', 11001)

# receive until just to be sure, can you say '
r.recvuntil("'")

# receive the actual 16 byte query
data = r.recv(16)

# dump the rest
r.recvline()

print '[*] received query: %s' % data

# repeat data
r.sendline(data)

# dump the yay!
flag = r.recvline()

# get flag
flag = r.recvline().strip()
print "[+] Flag: %s" % flag

f = open('flag.txt', 'rt')
f2 = f.read().strip()

assert f2 == flag
print "[+] Test succeeded"
